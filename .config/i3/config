################################################
# coredev-uk/dotfiles
################################################

set $mod Mod4
font pango:SF Compact Rounded 10

# APPS VARIABLES
set $browser    firefox
set $scrsht     flameshot gui
set $music      cider
set $term       alacritty
set $rofi 		rofi -show drun -theme $HOME/.config/rofi/config.rasi  # > /tmp/rofi.log 2>&1
set $picom      picom --config $HOME/.config/picom/picom.conf --experimental-backends
set $notif      /usr/lib/xfce4/notifyd/xfce4-notifyd 
set $lock       betterlockscreen -l dimblur
set $wallpaper  feh --bg-fill $HOME/Pictures/big-sur-night-grasses.jpg
set $rgbprof    orange-night

# RESIZE
set $center move position center
set $resize resize set 80 ppt 70 ppt

# GAPS
set $inner 10
set $outer 0
set $rounded 4

# TERMINAL BINDS
bindsym $mod+Return exec $term

# SCRATCHPAD
bindsym $mod+c scratchpad show $center, resize set 80 ppt 70 ppt
bindsym $mod+Shift+c floating enable, move position $inner px $inner px, $resize, move scratchpad
bindsym $mod+Ctrl+c exec $term --class scratch 

# BORDER COLOURS
set $fg "#FFFFFF"
set $ac "#5865F2"
set $bg "#2e3035"

# STACKING
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split
title_align center

# BORDER
default_floating_border pixel 0
default_border pixel 0
for_window [class="^.*"] border pixel 0
border_radius $rounded

# GAPS
gaps inner $inner
gaps outer $outer

# GAPS COMMAND
bindsym $mod+g exec $picom; gaps inner all set $inner; gaps outer all set $outer
bindsym $mod+Shift+g exec $picom; gaps inner all set 0; gaps outer all set 0

new_window 1pixel
smart_borders on

# FLOATING
floating_modifier $mod
bindsym $mod+Shift+space floating toggle; $center

# CLASS                 BORDER  BACK    TEXT    INDICATOR
client.focused          $bg     $ac     $fg     $bg
client.focused_inactive $bg     $ac     $fg     $bg 
client.unfocused        $bg     $bg     $fg     $bg
client.urgent           $bg     $bg     $fg     $bg 
client.placeholder      $bg     $bg     $fg     $bg

# EXIT
bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -B 'Yes, exit i3' 'i3-msg exit'"

# RELOAD
bindsym $mod+Ctrl+r reload

# RESTART
bindsym $mod+Shift+r restart

###############################################
##### WINDOW RULES ############################
###############################################

# STEAN
for_window [class="^Steam$" title="^Friends$"] floating enable
for_window [class="^Steam$" title="^Friends List$"] floating enable
for_window [class="^Steam$" title="Steam - News"] floating enable
for_window [class="^Steam$" title=".* - Chat"] floating enable
for_window [class="^Steam$" title="^Settings$"] floating enable
for_window [class="^Steam$" title=".* - event started"] floating enable
for_window [class="^Steam$" title=".* CD key"] floating enable
for_window [class="^Steam$" title="^Steam - Self Updater$"] floating enable
for_window [class="^Steam$" title="^Screenshot Uploader$"] floating enable
for_window [class="^Steam$" title="^Steam Guard - Computer Authorization Required$"] floating enable
for_window [class="^Steam$" title="Steam Library Folders"] floating enable
for_window [class="^Steam$" title="Create or select new Steam library folder:"] floating enable
for_window [title="^Steam Keyboard$"] floating enable
for_window [class="steam_app_*"] floating disable

# JETBRAINS
for_window [class="jetbrains-*" title="win0"] floating enable
for_window [class="jetbrains-*" title="Welcome to *"] floating enable
for_window [class="^com-intellij-updater-Runner$" title="^Update$"] floating enable
for_window [instance="^sun-awt-X11-XDialogPeer$" title="^Complete Installation$"] floating enable

# OTHER
for_window [class="origin.exe"] floating enable
for_window [class="^Pavucontrol$"] floating enable
for_window [class="Lutris" title="Manage Runners"] floating enable
for_window [class="feh"] floating enable

###############################################
##### TOOLS ###################################
###############################################

# MEDIA KEYS
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume        exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +2% && $refresh_i3status
bindsym XF86AudioLowerVolume        exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -2% && $refresh_i3status
bindsym XF86AudioMute               exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status
bindsym XF86AudioMicMute            exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status
bindsym XF86AudioPlay               exec playerctl play-pause
bindsym XF86AudioPause              exec playerctl play-pause
bindsym XF86AudioNext               exec playerctl next
bindsym XF86AudioPrev               exec playerctl previous

# ROFI
bindsym $mod+space      exec --no-startup-id $rofi

bindsym $mod+l          exec $lock # LOCK
bindsym $mod+b          exec $browser # BROWSER
bindsym Ctrl+Print      exec $scrsht # SCREENSHOTTING

###############################################
##### MOVEMENT ################################
###############################################

# KILL
bindsym $mod+q kill

# FOCUS CHANGE
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# MOVE FOCUSED
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# FOCUS DIFF MONITOR
bindsym $mod+Ctrl+Right focus output right
bindsym $mod+Ctrl+Left focus output left

# HORIZONTAL SPLIT
bindsym $mod+h split h

# VERTICAL SPLIT
bindsym $mod+v split v

# FULLSCREEN MODE
bindsym $mod+f fullscreen toggle

# FOCUS CHANGE (TILING/FLOATING)
bindsym $mod+d focus mode_toggle

# CHANGE TO PARENT
bindsym $mod+a focus parent

# RESIZE MODE
bindsym $mod+r mode "resize"

###############################################
##### WORKSPACES ##############################
###############################################

set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10"

# SWITCHING
bindsym $mod+1 workspace number $ws1
bindsym $mod+2 workspace number $ws2
bindsym $mod+3 workspace number $ws3
bindsym $mod+4 workspace number $ws4
bindsym $mod+5 workspace number $ws5
bindsym $mod+6 workspace number $ws6
bindsym $mod+7 workspace number $ws7
bindsym $mod+8 workspace number $ws8
bindsym $mod+9 workspace number $ws9
bindsym $mod+0 workspace number $ws10

# MOVING
bindsym $mod+Shift+1 move container to workspace number $ws1
bindsym $mod+Shift+2 move container to workspace number $ws2
bindsym $mod+Shift+3 move container to workspace number $ws3
bindsym $mod+Shift+4 move container to workspace number $ws4
bindsym $mod+Shift+5 move container to workspace number $ws5
bindsym $mod+Shift+6 move container to workspace number $ws6
bindsym $mod+Shift+7 move container to workspace number $ws7
bindsym $mod+Shift+8 move container to workspace number $ws8
bindsym $mod+Shift+9 move container to workspace number $ws9
bindsym $mod+Shift+0 move container to workspace number $ws10

# RESIZE BINDS
mode "resize" {
    bindsym j resize shrink width 10 px or 10 ppt
    bindsym k resize grow height 10 px or 10 ppt
    bindsym l resize shrink height 10 px or 10 ppt
    bindsym semicolon resize grow width 10 px or 10 ppt

    bindsym Left resize shrink width 10 px or 10 ppt
    bindsym Down resize grow height 10 px or 10 ppt
    bindsym Up resize shrink height 10 px or 10 ppt
    bindsym Right resize grow width 10 px or 10 ppt
    
    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+r mode "default"
}

##### LAUNCH ##############################

exec --no-startup-id xidlehook --not-when-fullscreen --not-when-audio --timer 300 $lock '' --timer 120 'systemctl suspend' '' 
exec --no-startup-id liquidctl --match hydro set fan speed 20
exec --no-startup-id $notif
exec --no-startup-id numlockx
exec --no-startup-id openrgb --startminimized -p $rgbprof
exec --no-startup-id "setxkbmap -layout gb"
exec --no-startup-id /usr/lib/geoclue-2.0/demos/agent

exec_always --no-startup-id $wallpaper
exec_always --no-startup-id $picom
exec_always --no-startup-id "~/.config/polybar/launch.sh"
exec_always --no-startup-id "/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1"
